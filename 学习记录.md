# 1.introduction

1. stackblitz:
   一个远程网站
   可以实现网页版编程
   同时他的分享功能有助于别人上手调试代码
2. 终端运行：
   > node index.js
   > 可以运行相应 js 文件
   > node
   > 打开 spel 环境
   > 交互式编程

## 文件读写

> import{ appendFile } from "node:fs/promises";
> 导入 appendFile,readFile,writeFile
> const data = await readFile("./data.json", "utf8");
> //await writeFile("./data.json", "alex-john", "utf8"); //覆写内容
> await appendFile("./data.json", "\nalex-john", "utf8"); //添加内容
> console.log(data);

## 同步与异步

1.  同步：多用户任务处理按一定顺序依次执行任务，一次执行一个，其他任务中断
2.  异步：同时处理多用户的任务，不中断其他任务
3.  commonjs 和 es 的差异：
    - 前者为同步语法，后者为异步语法
    - 后者更为贴近现代浏览器 javascript 环境
4.  同步代码时常常遇到 callback，即回调函数
    > import { readFile as readFileSync } from "node:fs";
    > import { readFile } from "node:fs/promises";
    > // readFile 有两个参数 path, options
    > // readFileSync 有三个参数 path, options, callback
    > readFileSync("./data.json", "utf8", (error, data) => {
    > if (error) {
        console.log(error); //打印错误
    }
    console.log(data); //正常打印数据
    });
    >

## project1

> import { readFile, appendFile, writeFile } from "node:fs/promises";
> const data = await readFile("./data.txt", "utf8");
> const key = await readFile("./keychain.txt", "utf8");
> // const numbers_data = Array.from(data).map((char) => char.charCodeAt(0));
> // for (let i = 0; i < data.length; i++) {
> // numbers_data[i] += Number(key);
> // }
> // const out = String.fromCharCode(...numbers_data);
> // const numbers_data_n = Array.from(data).map((char) => char.charCodeAt(0));
> // for (let i = 0; i < data.length; i++) {
> // numbers_data_n[i] -= Number(key);
> // }
> // const out_n = String.fromCharCode(...numbers_data_n);
> const out_n = data.split("").map((currentchar) => {
>
> > const out_code = currentchar.charCodeAt(0) - Number(key);
> > return String.fromCharCode(out_code);
>
> });
> // await writeFile("./out.txt", out, "utf8");
> await writeFile("./out.txt", out_n, "utf8");

## 读入交互

    import { createInterface } from "node:readline/promises";
    import { stdin, stdout } from "node:process";

    const readLine = createInterface({
    input: stdin,
    output: stdout,
    });
    const name = await readLine.question("What's your name?\n");
    console.log(`Welcome: ${name}`);
    readLine.close();

## 服务器

1. 浏览器和服务器三次握手：确认两边的收发正常
2. 浏览器发送请求，服务器返回 html 文件，还有其他类型的数据，需要指明数据类型

## 简单搭建

1.  creatServer:
    1. writeHead: 写明文件应用
    2. readFile: 读取文件
    3. end: 输出
2.  server.listen: 监听

        import { readFile } from "node:fs/promises";
        import { createServer } from "node:http";

        const server = createServer(async (request, response) => {
        //返回一个纯文本
        // response.writeHead(200, { "content-type": "text/plain" });
        // response.end("Hello World!\n");

        //返回一个 html
        // response.writeHead(200, { "content-type": "text/html" });
        // const htmlFile = await readFile("./index.html", "utf-8");
        // response.end(htmlFile);

        // 返回一个 json 文件
        response.writeHead(200, { "content-type": "application/json" });
        const jsonFile = await readFile("./data.json", "utf-8");
        response.end(jsonFile);
        });

        server.listen(3000, "127.0.0.1", () => {
        console.log("Listening on 127.0.0.1:3000");
        });

## 路由

1.  定义：url，网站地址
2.  通过 request.url 的条件判定返回相应内容：

        import { readFile } from "node:fs/promises";
        import { createServer } from "node:http";

        const server = createServer(async (request, response) => {
        if (request.url === "/") {
            response.writeHead(200, { "Content-Type": "text/html" });
            const htmlFile = await readFile("./index.html", "utf-8");
            response.end(htmlFile);
        }
        if (request.url === "/data") {
            const jsonFile = await readFile("./data.json", "utf-8");
            response.writeHead(200, { "content-type": "application/json" });
            response.end(jsonFile);
        }
        });

        server.listen(3000, "127.0.0.1", () => {
        console.log("Listening on 127.0.0.1:3000");
        });

## 服务器类型（返回方式）

1. SSR:HTML,CSS,javascript,JSON
2. CCSR/SPA: CSS,Javascript,HTML----JSON
3. compare:
   - ssr is faster,but need to reload when calling a usl,it wil ocupate CPU much.
   - spa can cutdown the requirement to coder and easier to be maitained

## HEllo express

1.  download:

    pnpm add express

2.  write package.json: "type":"module"

3.  hello world:

        import express from "express";

        const app = express();
        const port = 3000;

        app.get("/", (req, res) => {
        res.send("Hello World!");
        });

        app.listen(port, () => {
        //local ip address: 127.0.0.1
        console.log(`Example app listening on port ${port}`);
        });

##
